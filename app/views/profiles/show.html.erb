<div class="card mx-auto text-center p-4" style="max-width: 600px;">
  <% if @user.avatar.attached? %>
    <%= image_tag @user.avatar, class: "rounded-circle mb-3", width: 120, height: 120 %>
  <% end %>

  <h2 class="mb-1">@<%= @user.username %></h2>
  <p class="text-muted"><%= @user.bio.presence || "Este usuário ainda não adicionou uma bio." %></p>

  <!-- Estatísticas de seguidores -->
  <div class="d-flex justify-content-center gap-4 my-3">
    <%= link_to user_followers_path(username: @user.username), class: "text-decoration-none text-dark" do %>
      <div>
        <strong><%= @user.followers_count %></strong>
        <small class="text-muted d-block">Seguidores</small>
      </div>
    <% end %>
    
    <%= link_to user_following_path(username: @user.username), class: "text-decoration-none text-dark" do %>
      <div>
        <strong><%= @user.following_count %></strong>
        <small class="text-muted d-block">Seguindo</small>
      </div>
    <% end %>
    
    <div>
      <strong><%= @projects&.count || 0 %></strong>
      <small class="text-muted d-block">Projetos</small>
    </div>
  </div>

  <!-- Botão de seguir -->
  <turbo-frame id="follow_button_<%= @user.id %>">
    <%= render "follow_button", user: @user %>
  </turbo-frame>

  <% if user_signed_in? && current_user == @user %>
    <div class="mt-3">
      <%= link_to "Criar novo projeto", new_project_path, class: "btn btn-success me-2" %>
    </div>
  <% end %>
</div>

<hr class="my-4">

<h4 class="mt-3">Projetos</h4>

<% if @projects.present? && @projects.any? %>
  <div class="row">
    <% @projects.each do |project| %>
      <div class="col-md-4">
        <%= link_to public_project_path(username: @user.username, project_slug: project.slug), class: "text-decoration-none text-dark" do %>
          <div class="card mb-3 h-100">
            <% if project.image.attached? %>
              <%= image_tag project.image, class: "card-img-top" %>
            <% end %>
            <div class="card-body">
              <h5><%= project.title %></h5>
              <p class="text-muted small"><%= truncate(project.description, length: 80) %></p>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
<% else %>
  <p class="text-muted">Nenhum projeto publicado ainda.</p>
<% end %>